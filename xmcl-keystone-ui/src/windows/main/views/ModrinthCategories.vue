<template>
  <v-card
    v-if="!loading"
    outlined
    class="p-4 rounded-lg flex flex-col h-[fit-content]"
  >
    <span class="list-title">{{ $t('modrinth.categories.name') }}</span>
    <span
      v-for="cat in categories"
      :key="cat.name"
      class="item"
      @click="$emit('select:category', cat.name)"
    >
      <v-checkbox
        :input-value="category.indexOf(cat.name) !== -1"
        hide-details
        class="mt-0 pt-0"
      />
      <div
        class="w-5 max-w-5 flex justify-center"
        v-html="cat.icon"
      />
      <div>
        {{ $te(`modrinth.categories.${cat.name}`) ? $t(`modrinth.categories.${cat.name}`) : cat.name.substring(1) }}
      </div>
    </span>
    <span class="list-title">{{ $t('modrinth.modLoaders.name') }}</span>
    <span
      v-for="l in loaders"
      :key="l.name"
      class="item"
      @click="$emit('select:modLoader', l.name)"
    >
      <v-checkbox
        :input-value="l.name === modLoader"
        hide-details
        class="mt-0 pt-0"
      />
      <div
        class="w-5 max-w-5 flex justify-center"
        v-html="l.icon"
      />
      {{ $te(`modrinth.categories.${l.name}`) ? $t(`modrinth.categories.${l.name}`) : (l.name[0].toUpperCase() + l.name.substring(1)) }}
    </span>
    <span class="list-title">{{ $t('modrinth.environments.name') }}</span>
    <span
      v-for="env in environments"
      :key="env"
      class="item"
      @click="$emit('select:environment', env)"
    >
      <v-checkbox
        :input-value="env === environment"
        hide-details
        class="mt-0 pt-0"
      />
      {{ $t(`modrinth.environments.${env}`) }}
    </span>
    <span class="list-title">{{ $t('modrinth.gameVersions.name') }}</span>
    <v-select
      solo
      flat
      clearable
      :label="$t('modrinth.gameVersions.name')"
      :items="gameVersions.map(v => v.version)"
      hide-details
      :value="gameVersion"
      @input="$emit('select:gameVersion', $event == null ? '' : $event)"
    />
    <span class="list-title">{{ $t('modrinth.licenses.name') }}</span>
    <v-select
      solo
      flat
      clearable
      :label=" $t('modrinth.licenses.name') "
      :items="licenses"
      :item-text="
        // @ts-expect-error
        v => v.name"
      :item-value="
        // @ts-expect-error
        v => v.short"
      :value="license"
      hide-details
      @input="$emit('select:license', $event)"
    />
  </v-card>
  <v-card
    v-else
    class="p-4 rounded-lg flex flex-col h-[fit-content]"
    outlined
  >
    <v-skeleton-loader
      class="flex flex-col gap-3 overflow-auto"
      type="list-item-avatar-two-line, list-item-avatar-two-line, list-item-avatar-two-line, list-item-avatar-two-line, list-item-avatar-two-line, list-item-avatar-two-line"
    />
  </v-card>
</template>
<script lang="ts">
import { defineComponent } from '@vue/composition-api'
import { required } from '/@/util/props'
import { Category, GameVersion, License, Loader } from '@xmcl/modrinth'

export default defineComponent({
  props: {
    loading: required<boolean>(Boolean),
    categories: required<Category[]>(Array),
    category: required<string[]>(Array),
    loaders: required<Loader[]>(Array),
    modLoader: required(String),
    environments: required<string[]>(Array),
    environment: required(String),
    gameVersions: required<GameVersion[]>(Array),
    gameVersion: required(String),
    licenses: required<License[]>(Array),
    license: required(String),
  },
})
</script>

<style scoped>
.item {
  @apply rounded-lg ml-2 hover:bg-[rgba(255,255,255,0.2)] cursor-pointer p-1 pl-3 inline-flex gap-1 transition transition-all duration-250;
}

.list-title {
  @apply font-bold text-lg py-1;
}

.selected {
  @apply bg-[rgba(255,255,255,0.2)];
}

</style>
